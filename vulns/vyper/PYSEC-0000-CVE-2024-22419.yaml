id: PYSEC-0000-CVE-2024-22419
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
details: Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine.
  The `concat` built-in can write over the bounds of the memory buffer that was allocated
  for it and thus overwrite existing valid data. The root cause is that the `build_IR`
  for `concat` doesn't properly adhere to the API of copy functions (for `>=0.3.2`
  the `copy_bytes` function). A contract search was performed and no vulnerable contracts
  were found in production. The buffer overflow can result in the change of semantics
  of the contract. The overflow is length-dependent and thus it might go unnoticed
  during contract testing. However, certainly not all usages of concat will result
  in overwritten valid data as we require it to be in an internal function and close
  to the return statement where other memory allocations don't occur. This issue has
  been addressed in 0.4.0.
affected:
- package:
    name: vyper
    ecosystem: PyPI
    purl: pkg:pypi/vyper
  ranges:
  - type: GIT
    repo: https://github.com/vyperlang/vyper
    events:
    - introduced: "0"
    - fixed: 55e18f6d128b2da8986adbbcccf1cd59a4b9ad6f
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 0.4.0b1
references:
- type: EVIDENCE
  url: https://github.com/vyperlang/vyper/security/advisories/GHSA-2q8v-3gqq-4f8p
- type: ADVISORY
  url: https://github.com/vyperlang/vyper/security/advisories/GHSA-2q8v-3gqq-4f8p
- type: EVIDENCE
  url: https://github.com/vyperlang/vyper/issues/3737
- type: REPORT
  url: https://github.com/vyperlang/vyper/issues/3737
- type: ADVISORY
  url: https://github.com/vyperlang/vyper/issues/3737
- type: FIX
  url: https://github.com/vyperlang/vyper/commit/55e18f6d128b2da8986adbbcccf1cd59a4b9ad6f
aliases:
- CVE-2024-22419
- GHSA-2q8v-3gqq-4f8p
modified: "2024-10-09T20:15:00Z"
published: "2024-01-18T19:15:00Z"
